{
  "content": "\"\"\" Class used to create and control radamec device \"\"\"\nfrom panda3d.core import Vec3\nfrom direct.showbase.DirectObject import DirectObject\nfrom direct.task.Task import Task\nfrom direct.task.TaskManagerGlobal import taskMgr\nfrom .DirectDeviceManager import DirectDeviceManager\n\nfrom direct.directnotify import DirectNotifyGlobal\n\n#TODO: Handle interaction between widget, followSelectedTask and updateTask\n\n# ANALOGS\nNULL_AXIS = -1\nFAST_X = 0\nFAST_Y = 1\nFAST_Z = 2\n\nclass DirectFastrak(DirectObject):\n    fastrakCount = 0\n    notify = DirectNotifyGlobal.directNotify.newCategory('DirectFastrak')\n\n    def __init__(self, device = 'Tracker0', nodePath = None):\n        # See if device manager has been initialized\n        if base.direct.deviceManager is None:\n            base.direct.deviceManager = DirectDeviceManager()\n\n        # Set name\n        self.name = 'Fastrak-' + repr(DirectFastrak.fastrakCount)\n        self.deviceNo = DirectFastrak.fastrakCount\n        DirectFastrak.fastrakCount += 1\n\n        # Get analogs\n        self.device = device\n        self.tracker = None\n        self.trackerPos = None\n\n        # Spawn update task\n        self.updateFunc = self.fastrakUpdate\n        self.enable()\n\n    def enable(self):\n        # Kill existing task\n        self.disable()\n        # Initialize tracker\n        self.tracker = base.direct.deviceManager.createTracker(self.device)\n        # Update task\n        taskMgr.add(self.updateTask, self.name + '-updateTask')\n\n    def disable(self):\n        taskMgr.remove(self.name + '-updateTask')\n\n    def destroy(self):\n        self.disable()\n        self.tempCS.removeNode()\n\n    def updateTask(self, state):\n        self.updateFunc()\n        return Task.cont\n\n    def fastrakUpdate(self):\n        # Get tracker position in feet.  Flip x, z axes.\n        pos = base.direct.fastrak[self.deviceNo].tracker.getPos()\n        self.trackerPos = Vec3(3.280839895013123 * pos[2],\n                               3.280839895013123 * pos[1],\n                               3.280839895013123 * pos[0])\n        self.notify.debug(\"Tracker(%d) Pos = %s\" % (self.deviceNo, repr(self.trackerPos)))\n",
  "metadata": {
    "source": "corpus_panda3d/source_code/direct/src/directdevices/DirectFastrak.py",
    "doc_type": "python",
    "file_path": "processed_documents/context_documents/f1774c70_DirectFastrak.json",
    "doc_id": "doc_110"
  }
}