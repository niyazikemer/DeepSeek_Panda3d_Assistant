{
  "content": "\"\"\"Contains the Timer class.\"\"\"\n\n__all__ = ['Timer']\n\nfrom panda3d.core import ClockObject\n\nfrom . import Task\nfrom .TaskManagerGlobal import taskMgr\n\n\nclass Timer:\n    id = 0\n\n    def __init__(self, name=None):\n        self.finalT = 0.0\n        self.currT = 0.0\n        if name is None:\n            name = 'default-timer-%d' % Timer.id\n            Timer.id += 1\n        self.name = name\n        self.started = 0\n        self.callback = None\n\n    def start(self, t, name):\n        if self.started:\n            self.stop()\n        self.callback = None\n        self.finalT = t\n        self.name = name\n        self.startT = ClockObject.getGlobalClock().getFrameTime()\n        self.currT = 0.0\n        taskMgr.add(self.__timerTask, self.name + '-run')\n        self.started = 1\n\n    def startCallback(self, t, callback):\n        if self.started:\n            self.stop()\n        self.callback = callback\n        self.finalT = t\n        self.startT = ClockObject.getGlobalClock().getFrameTime()\n        self.currT = 0.0\n        taskMgr.add(self.__timerTask, self.name + '-run')\n        self.started = 1\n\n    def stop(self):\n        if not self.started:\n            return 0.0\n        taskMgr.remove(self.name + '-run')\n        self.started = 0\n        return self.currT\n\n    def resume(self):\n        assert self.currT <= self.finalT\n        assert self.started == 0\n        self.start(self.finalT - self.currT, self.name)\n\n    def restart(self):\n        if self.callback is not None:\n            self.startCallback(self.finalT, self.callback)\n        else:\n            self.start(self.finalT, self.name)\n\n    def isStarted(self):\n        return self.started\n\n    def addT(self, t):\n        self.finalT = self.finalT + t\n\n    def setT(self, t):\n        self.finalT = t\n\n    def getT(self):\n        return self.finalT - self.currT\n\n    def __timerTask(self, task):\n        t = ClockObject.getGlobalClock().getFrameTime()\n        te = t - self.startT\n        self.currT = te\n        if te >= self.finalT:\n            if self.callback is not None:\n                self.callback()\n            else:\n                from direct.showbase.MessengerGlobal import messenger\n                messenger.send(self.name)\n            return Task.done\n        return Task.cont\n",
  "metadata": {
    "source": "corpus_panda3d/source_code/direct/src/task/Timer.py",
    "doc_type": "python",
    "file_path": "processed_documents/context_documents/a11a72f4_Timer.json",
    "doc_id": "doc_211"
  }
}